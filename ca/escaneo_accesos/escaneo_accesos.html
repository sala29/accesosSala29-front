<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Escanear accesos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <link rel="stylesheet" href="style.css">
    <style>
        /*  SOLO LAYOUT SIN SCROLL  no toca colores ni componentes existentes */

        html, body {
            height: 100%;
            overflow: hidden;
        }

        /* Contenedor principal: columna que ocupa exactamente la pantalla */
        .main-layout {
            display: flex;
            flex-direction: column;
            height: 100dvh;                          /* dynamic viewport height */
            padding-bottom: env(safe-area-inset-bottom, 0px);
        }

        /* Header: tama帽o fijo */
        .header {
            flex-shrink: 0;
            padding: 14px 20px;                      /* reducido del original 20px */
        }

        /* Zona del bot贸n c谩mara: ocupa el espacio sobrante */
        .scanner-container {
            flex: 1 1 0;
            min-height: 0;
            margin-top: 0;                           /* anula el margin-top:40px original */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Reducimos el bot贸n en pantallas peque帽as para que quepan los inputs */
        @media (max-height: 680px) {
            .scan-btn {
                width: 150px !important;
                height: 150px !important;
                font-size: 50px !important;
            }
        }
        @media (min-height: 681px) and (max-height: 780px) {
            .scan-btn {
                width: 180px !important;
                height: 180px !important;
                font-size: 60px !important;
            }
        }

        /* Secci贸n DNI/ID: tama帽o fijo, sin margen extra */
        .dni-section {
            flex-shrink: 0;
            margin: 0 20px 12px;                     /* anula margin:40px original */
            text-align: center;
        }

        .dni-section h2 {
            font-size: 14px;
            margin-bottom: 6px;
        }

        .dni-section input {
            padding: 11px 14px;                      /* un poco menos que los 14px originales */
            font-size: 16px;
            margin-bottom: 8px;
        }

        .dni-section button {
            padding: 11px 14px;
            font-size: 15px;
        }
    </style>
</head>
<body>

<!-- Envolvemos header + scanner + secciones en un flex column -->
<div class="main-layout">

    <div class="header">
        <h1 id="nombreEvento">Evento</h1>
        <button id="salirBtn" class="salir">Salir</button>
    </div>

    <div class="scanner-container">
        <button id="scanBtn" class="scan-btn"></button>
    </div>

    <!-- Acceso por N煤m Socio -->
    <div class="dni-section">
        <h2>Acceder con N煤m Socio</h2>
        <input
            type="number"
            id="idInput"
            placeholder="Ej: 42"
            autocomplete="off"
            inputmode="numeric"
        >
        <button id="buscarIdBtn">BUSCAR USUARIO</button>
    </div>

    <!-- Acceso por DNI -->
    <div class="dni-section">
        <h2>Acceder con DNI</h2>
        <input
            type="text"
            id="dniInput"
            placeholder="Ej: 12345678A"
            inputmode="text"
            autocomplete="off"
        >
        <button id="buscarDniBtn">BUSCAR USUARIO</button>
    </div>

</div>
<!-- fin main-layout -->


<!--  TODO LO DEMS SIN TOCAR  -->

<div id="sheetOverlay" class="sheet-overlay"></div>

<div id="userSheet" class="sheet">
    <div class="sheet-handle"></div>
    <div class="sheet-content">

        <div class="sheet-header">
            <div class="avatar">
                <img id="uFoto">
                <div id="fotoPlaceholder" class="placeholder"></div>
            </div>
            <h2 id="uNombre"></h2>
            <p id="uDni" class="muted"></p>
            <div class="estado">
                <span id="estadoVerificado"></span>
                <span id="estadoBloqueado"></span>
            </div>
        </div>

        <div class="info-grid">
            <div><span>ID</span><strong id="uId"></strong></div>
            <div><span>Nacimiento</span><strong id="uNacimiento"></strong></div>
            <div><span>Email</span><strong id="uEmail"></strong></div>
            <div><span>M贸vil</span><strong id="uTelefono"></strong></div>
        </div>

        <div id="feedback" class="feedback"></div>

        <div class="acciones">
            <button id="verificarBtn" class="btn-secundario">Verificar usuario</button>
            <button id="accesoBtn" class="btn-principal">ACCESO</button>
        </div>

    </div>
</div>

<div id="qrScreen" class="qr-screen" style="display:none">
    <div class="qr-header"><h2>Escanear QR</h2></div>
    <div id="qr-reader"></div>
    <button id="cancelarQrBtn" class="cancelar-qr">Cancelar</button>
</div>

<script src="https://unpkg.com/html5-qrcode"></script>
<script src="escaneo_accesos.js"></script>

</body>
</html>